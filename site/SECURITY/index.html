
<!doctype html>
<html lang="de" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Einheitliche UDS3 Doku mit API-Referenz und LeitfÃ¤den">
      
      
      
        <link rel="canonical" href="https://makr-code.github.io/VCC-UDS3/SECURITY/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>UDS3 Security Architecture - VCC UDS3 Dokumentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#uds3-security-architecture" class="md-skip">
          Zum Inhalt
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Kopfzeile">
    <a href=".." title="VCC UDS3 Dokumentation" class="md-header__button md-logo" aria-label="VCC UDS3 Dokumentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VCC UDS3 Dokumentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              UDS3 Security Architecture
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Suche" placeholder="Suche" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Suche">
        
        <button type="reset" class="md-search__icon md-icon" title="ZurÃ¼cksetzen" aria-label="ZurÃ¼cksetzen" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Suche wird initialisiert
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/makr-code/VCC-UDS3" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/VCC-UDS3
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Hauptnavigation" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.md" class="md-tabs__link">
        
  
  
    
  
  Start

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
  API-Referenz

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VCC UDS3 Dokumentation" class="md-nav__button md-logo" aria-label="VCC UDS3 Dokumentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    VCC UDS3 Dokumentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/makr-code/VCC-UDS3" title="Zum Repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    makr-code/VCC-UDS3
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API-Referenz
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API-Referenz
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ãœbersicht
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Inhaltsverzeichnis">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Inhaltsverzeichnis
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      ğŸ“‹ Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Security Principles
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Security Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Component Overview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#role-based-access-control-rbac" class="md-nav__link">
    <span class="md-ellipsis">
      Role-Based Access Control (RBAC)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Role-Based Access Control (RBAC)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-roles" class="md-nav__link">
    <span class="md-ellipsis">
      User Roles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permission-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Permission Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Database Permissions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#row-level-security-rls" class="md-nav__link">
    <span class="md-ellipsis">
      Row-Level Security (RLS)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Row-Level Security (RLS)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-rls-works" class="md-nav__link">
    <span class="md-ellipsis">
      How RLS Works
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-user-can-only-see-own-data" class="md-nav__link">
    <span class="md-ellipsis">
      Example: User Can Only See Own Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#record-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Record Metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-control-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Access Control Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pki-integration" class="md-nav__link">
    <span class="md-ellipsis">
      PKI Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PKI Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certificate-based-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate-Based Authentication
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certificate-validation" class="md-nav__link">
    <span class="md-ellipsis">
      Certificate Validation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-model-with-pki" class="md-nav__link">
    <span class="md-ellipsis">
      User Model with PKI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-logging" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Logging
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Audit Logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-gets-logged" class="md-nav__link">
    <span class="md-ellipsis">
      What Gets Logged
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-log-entry" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Log Entry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#querying-audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Querying Audit Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sample-audit-log" class="md-nav__link">
    <span class="md-ellipsis">
      Sample Audit Log
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rate-limiting" class="md-nav__link">
    <span class="md-ellipsis">
      Rate Limiting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rate Limiting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Purpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limits-by-role" class="md-nav__link">
    <span class="md-ellipsis">
      Rate Limits by Role
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limit-enforcement" class="md-nav__link">
    <span class="md-ellipsis">
      Rate Limit Enforcement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limit-response" class="md-nav__link">
    <span class="md-ellipsis">
      Rate Limit Response
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Best Practices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-always-use-secure-api" class="md-nav__link">
    <span class="md-ellipsis">
      1. Always Use Secure API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-validate-user-context" class="md-nav__link">
    <span class="md-ellipsis">
      2. Validate User Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-use-least-privilege" class="md-nav__link">
    <span class="md-ellipsis">
      3. Use Least Privilege
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitor-audit-logs" class="md-nav__link">
    <span class="md-ellipsis">
      4. Monitor Audit Logs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-handle-security-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      5. Handle Security Exceptions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-guide" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation Guide
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Guide">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-existing-code" class="md-nav__link">
    <span class="md-ellipsis">
      Integration with Existing Code
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security-test-suite" class="md-nav__link">
    <span class="md-ellipsis">
      Security Test Suite
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      Test Coverage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-security-test" class="md-nav__link">
    <span class="md-ellipsis">
      Example Security Test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Security Checklist
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#support-contact" class="md-nav__link">
    <span class="md-ellipsis">
      Support &amp; Contact
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/makr-code/VCC-UDS3/edit/master/docs/SECURITY.md" title="Seite editieren" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="uds3-security-architecture">UDS3 Security Architecture<a class="headerlink" href="#uds3-security-architecture" title="Permanent link">&para;</a></h1>
<p><strong>Comprehensive Security Framework for Multi-Database Access Control</strong></p>
<p>Version: 1.0.0<br />
Status: Production Ready<br />
Last Updated: 24. Oktober 2025</p>
<hr />
<h2 id="table-of-contents">ğŸ“‹ Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#security-architecture">Security Architecture</a></li>
<li><a href="#role-based-access-control-rbac">Role-Based Access Control (RBAC)</a></li>
<li><a href="#row-level-security-rls">Row-Level Security (RLS)</a></li>
<li><a href="#pki-integration">PKI Integration</a></li>
<li><a href="#audit-logging">Audit Logging</a></li>
<li><a href="#rate-limiting">Rate Limiting</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#implementation-guide">Implementation Guide</a></li>
<li><a href="#testing">Testing</a></li>
</ol>
<hr />
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>The UDS3 Security Layer provides <strong>enterprise-grade security</strong> for multi-database operations with:</p>
<ul>
<li>âœ… <strong>Row-Level Security (RLS)</strong> - Users can only access their own data</li>
<li>âœ… <strong>Role-Based Access Control (RBAC)</strong> - Least privilege principle enforced</li>
<li>âœ… <strong>PKI Certificate Authentication</strong> - Integration with VCC PKI system</li>
<li>âœ… <strong>Comprehensive Audit Logging</strong> - All operations tracked</li>
<li>âœ… <strong>API Rate Limiting</strong> - DOS protection and fair resource allocation</li>
<li>âœ… <strong>Zero-Trust Architecture</strong> - Every request authenticated and authorized</li>
</ul>
<h3 id="security-principles">Security Principles<a class="headerlink" href="#security-principles" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Least Privilege</strong> - Users have minimum necessary permissions</li>
<li><strong>Defense in Depth</strong> - Multiple security layers</li>
<li><strong>Fail Secure</strong> - Default deny on access checks</li>
<li><strong>Audit Everything</strong> - Complete audit trail</li>
<li><strong>Zero Trust</strong> - Never trust, always verify</li>
</ol>
<hr />
<h2 id="security-architecture">Security Architecture<a class="headerlink" href="#security-architecture" title="Permanent link">&para;</a></h2>
<h3 id="component-overview">Component Overview<a class="headerlink" href="#component-overview" title="Permanent link">&para;</a></h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        UDS3 Security Layer                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ PKI Auth       â”‚  â”‚ RBAC Engine    â”‚  â”‚ Rate Limiter   â”‚   â”‚
â”‚  â”‚ - Cert Valid   â”‚  â”‚ - 5 Roles      â”‚  â”‚ - Per-User     â”‚   â”‚
â”‚  â”‚ - CRL Check    â”‚  â”‚ - 15 Perms     â”‚  â”‚ - Quotas       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          Row-Level Security (RLS) Engine               â”‚    â”‚
â”‚  â”‚  - Owner Filtering                                     â”‚    â”‚
â”‚  â”‚  - Permission Checks                                   â”‚    â”‚
â”‚  â”‚  - Metadata Protection                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               Audit Logging System                      â”‚    â”‚
â”‚  â”‚  - All Operations                                       â”‚    â”‚
â”‚  â”‚  - Success &amp; Failures                                   â”‚    â”‚
â”‚  â”‚  - User Context                                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Secure Database API                            â”‚
â”‚  - create(user, data)                                           â”‚
â”‚  - read(user, filters)                                          â”‚
â”‚  - update(user, id, updates)                                    â”‚
â”‚  - delete(user, id)                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Multi-Database Backends                             â”‚
â”‚   PostgreSQL  â”‚  Neo4j  â”‚  CouchDB  â”‚  ChromaDB                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr />
<h2 id="role-based-access-control-rbac">Role-Based Access Control (RBAC)<a class="headerlink" href="#role-based-access-control-rbac" title="Permanent link">&para;</a></h2>
<h3 id="user-roles">User Roles<a class="headerlink" href="#user-roles" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Role</th>
<th>Description</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SYSTEM</strong></td>
<td>Full system access</td>
<td>Internal services only</td>
</tr>
<tr>
<td><strong>ADMIN</strong></td>
<td>Administrative access</td>
<td>System administrators</td>
</tr>
<tr>
<td><strong>SERVICE</strong></td>
<td>Service-to-Service</td>
<td>Inter-service communication</td>
</tr>
<tr>
<td><strong>USER</strong></td>
<td>Standard user</td>
<td>Regular application users</td>
</tr>
<tr>
<td><strong>READONLY</strong></td>
<td>Read-only access</td>
<td>Viewers, auditors</td>
</tr>
</tbody>
</table>
<h3 id="permission-matrix">Permission Matrix<a class="headerlink" href="#permission-matrix" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Permission</th>
<th>SYSTEM</th>
<th>ADMIN</th>
<th>SERVICE</th>
<th>USER</th>
<th>READONLY</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DATA_READ_OWN</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td><code>DATA_READ_ALL</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>DATA_WRITE_OWN</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>DATA_WRITE_ALL</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>DATA_DELETE_OWN</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>DATA_DELETE_ALL</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>SCHEMA_READ</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td><code>SCHEMA_MODIFY</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>ADMIN_BACKUP</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>ADMIN_RESTORE</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>ADMIN_USERS</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>ADMIN_AUDIT</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>BATCH_READ</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>BATCH_WRITE</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td><code>SEARCH_EXECUTE</code></td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âŒ</td>
</tr>
</tbody>
</table>
<h3 id="database-permissions">Database Permissions<a class="headerlink" href="#database-permissions" title="Permanent link">&para;</a></h3>
<p>15 granular permissions control database operations:</p>
<pre><code class="language-python">class DatabasePermission(Enum):
    # Data Operations
    DATA_READ_OWN = &quot;data:read:own&quot;          # âœ… USER
    DATA_READ_ALL = &quot;data:read:all&quot;          # âœ… ADMIN only
    DATA_WRITE_OWN = &quot;data:write:own&quot;        # âœ… USER
    DATA_WRITE_ALL = &quot;data:write:all&quot;        # âœ… ADMIN only
    DATA_DELETE_OWN = &quot;data:delete:own&quot;      # âœ… USER
    DATA_DELETE_ALL = &quot;data:delete:all&quot;      # âœ… ADMIN only

    # Schema Operations
    SCHEMA_READ = &quot;schema:read&quot;              # âœ… ALL
    SCHEMA_MODIFY = &quot;schema:modify&quot;          # âœ… ADMIN only

    # Admin Operations
    ADMIN_BACKUP = &quot;admin:backup&quot;            # âœ… ADMIN only
    ADMIN_RESTORE = &quot;admin:restore&quot;          # âœ… ADMIN only
    ADMIN_USERS = &quot;admin:users&quot;              # âœ… ADMIN only
    ADMIN_AUDIT = &quot;admin:audit&quot;              # âœ… ADMIN only

    # Batch Operations
    BATCH_READ = &quot;batch:read&quot;                # âœ… USER+
    BATCH_WRITE = &quot;batch:write&quot;              # âœ… SERVICE+

    # Search &amp; Query
    SEARCH_EXECUTE = &quot;search:execute&quot;        # âœ… USER+
</code></pre>
<hr />
<h2 id="row-level-security-rls">Row-Level Security (RLS)<a class="headerlink" href="#row-level-security-rls" title="Permanent link">&para;</a></h2>
<h3 id="how-rls-works">How RLS Works<a class="headerlink" href="#how-rls-works" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Automatic Owner Injection</strong> - All created records get <code>_owner_user_id</code> metadata</li>
<li><strong>Filter Enforcement</strong> - Queries automatically filtered by ownership</li>
<li><strong>Permission Checks</strong> - Every operation verified before execution</li>
<li><strong>Metadata Protection</strong> - System metadata cannot be manipulated</li>
</ol>
<h3 id="example-user-can-only-see-own-data">Example: User Can Only See Own Data<a class="headerlink" href="#example-user-can-only-see-own-data" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># Alice creates documents
secure_api.create(alice, {&quot;title&quot;: &quot;Alice's Document&quot;})
secure_api.create(alice, {&quot;title&quot;: &quot;Alice's Secret&quot;})

# Bob creates documents
secure_api.create(bob, {&quot;title&quot;: &quot;Bob's Document&quot;})

# Alice queries all documents
alice_docs = secure_api.read(alice, {})
# Result: Only Alice's 2 documents (NOT Bob's!)

# Bob queries all documents
bob_docs = secure_api.read(bob, {})
# Result: Only Bob's 1 document (NOT Alice's!)

# Admin queries all documents
admin_docs = secure_api.read(admin, {})
# Result: ALL 3 documents (Alice's + Bob's)
</code></pre>
<h3 id="record-metadata">Record Metadata<a class="headerlink" href="#record-metadata" title="Permanent link">&para;</a></h3>
<p>Every record automatically gets:</p>
<pre><code class="language-python">{
    &quot;_owner_user_id&quot;: &quot;user001&quot;,           # Who owns this record
    &quot;_created_by&quot;: &quot;alice&quot;,                # Username of creator
    &quot;_created_at&quot;: &quot;2025-10-24T17:00:00&quot;,  # Creation timestamp
    &quot;_updated_by&quot;: &quot;alice&quot;,                # Last modifier (optional)
    &quot;_updated_at&quot;: &quot;2025-10-24T18:00:00&quot;   # Last update (optional)
}
</code></pre>
<h3 id="access-control-flow">Access Control Flow<a class="headerlink" href="#access-control-flow" title="Permanent link">&para;</a></h3>
<pre><code>User Request â†’ Rate Limit Check â†’ Permission Check â†’ RLS Filter
    â†“                  â†“                  â†“               â†“
 Allowed?          Not Exceeded?      Has Permission?   Owns Data?
    â†“                  â†“                  â†“               â†“
   YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ YES â†’ âœ… GRANTED
    â†“                  â†“                  â†“               â†“
   NO                 NO                 NO              NO  â†’ âŒ DENIED
    â†“                  â†“                  â†“               â†“
Security           Rate Limit       Permission         Access
Exception          Exception        Exception          Denied (null)
</code></pre>
<hr />
<h2 id="pki-integration">PKI Integration<a class="headerlink" href="#pki-integration" title="Permanent link">&para;</a></h2>
<h3 id="certificate-based-authentication">Certificate-Based Authentication<a class="headerlink" href="#certificate-based-authentication" title="Permanent link">&para;</a></h3>
<p>The UDS3 Security Layer integrates with the <strong>VCC PKI System</strong> for certificate-based authentication:</p>
<pre><code class="language-python"># Initialize with PKI
security = UDS3SecurityManager(
    pki_ca_cert_path=&quot;/path/to/ca.pem&quot;,
    enable_pki_auth=True
)

# Authenticate user from client certificate
user = security.authenticate(cert_pem=client_cert)

# User object contains certificate metadata
print(user.certificate_cn)          # Common Name
print(user.certificate_serial)      # Serial number
print(user.certificate_fingerprint) # SHA-256 fingerprint
</code></pre>
<h3 id="certificate-validation">Certificate Validation<a class="headerlink" href="#certificate-validation" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Chain Validation</strong> - Verify certificate signed by trusted CA</li>
<li><strong>Expiration Check</strong> - Ensure certificate still valid</li>
<li><strong>Revocation Check</strong> - Check Certificate Revocation List (CRL)</li>
<li><strong>Role Extraction</strong> - Extract user role from certificate extensions</li>
</ol>
<h3 id="user-model-with-pki">User Model with PKI<a class="headerlink" href="#user-model-with-pki" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@dataclass
class User:
    user_id: str
    username: str
    email: str
    role: UserRole

    # PKI Certificate Info
    certificate_cn: Optional[str]          # Common Name
    certificate_serial: Optional[str]      # Serial number
    certificate_fingerprint: Optional[str] # SHA-256 fingerprint
    service_name: Optional[str]            # For service accounts
</code></pre>
<hr />
<h2 id="audit-logging">Audit Logging<a class="headerlink" href="#audit-logging" title="Permanent link">&para;</a></h2>
<h3 id="what-gets-logged">What Gets Logged<a class="headerlink" href="#what-gets-logged" title="Permanent link">&para;</a></h3>
<p><strong>Every database operation</strong> is logged with:</p>
<ul>
<li>âœ… Timestamp</li>
<li>âœ… User ID &amp; Username</li>
<li>âœ… User Role</li>
<li>âœ… Action (read/write/delete/etc.)</li>
<li>âœ… Resource Type &amp; ID</li>
<li>âœ… Success/Failure status</li>
<li>âœ… Error message (if failed)</li>
<li>âœ… Certificate serial (if PKI auth)</li>
</ul>
<h3 id="audit-log-entry">Audit Log Entry<a class="headerlink" href="#audit-log-entry" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">@dataclass
class AuditLogEntry:
    timestamp: datetime
    user_id: str
    username: str
    role: UserRole
    action: str              # &quot;read&quot;, &quot;write&quot;, &quot;delete&quot;, etc.
    resource_type: str       # &quot;document&quot;, &quot;schema&quot;, etc.
    resource_id: Optional[str]
    success: bool
    error_message: Optional[str]
    certificate_serial: Optional[str]
</code></pre>
<h3 id="querying-audit-logs">Querying Audit Logs<a class="headerlink" href="#querying-audit-logs" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># Admin retrieves audit log
audit_log = secure_api.get_user_audit_log(
    admin_user,
    target_user_id=&quot;user001&quot;,  # Optional filter
    action=&quot;read&quot;,              # Optional filter
    start_time=yesterday,       # Optional time range
    end_time=now
)

# Example output
for entry in audit_log:
    print(f&quot;{entry['timestamp']}: {entry['username']} &quot;
          f&quot;{entry['action']} {entry['resource_type']}/{entry['resource_id']} &quot;
          f&quot;â†’ {'âœ…' if entry['success'] else 'âŒ'}&quot;)
</code></pre>
<h3 id="sample-audit-log">Sample Audit Log<a class="headerlink" href="#sample-audit-log" title="Permanent link">&para;</a></h3>
<pre><code>2025-10-24 17:30:15: alice read document/doc123 â†’ âœ…
2025-10-24 17:30:20: bob read document/doc123 â†’ âŒ Permission denied
2025-10-24 17:30:25: alice write document/doc123 â†’ âœ…
2025-10-24 17:30:30: alice delete document/doc123 â†’ âœ…
2025-10-24 17:30:35: admin read document/doc456 â†’ âœ…
</code></pre>
<hr />
<h2 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">&para;</a></h2>
<h3 id="purpose">Purpose<a class="headerlink" href="#purpose" title="Permanent link">&para;</a></h3>
<ul>
<li>âœ… <strong>DOS Protection</strong> - Prevent abuse</li>
<li>âœ… <strong>Fair Resource Allocation</strong> - Equal access for all</li>
<li>âœ… <strong>Cost Control</strong> - Limit expensive operations</li>
</ul>
<h3 id="rate-limits-by-role">Rate Limits by Role<a class="headerlink" href="#rate-limits-by-role" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Role</th>
<th>Requests/Minute</th>
<th>Requests/Hour</th>
<th>Requests/Day</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SYSTEM</strong></td>
<td>10,000</td>
<td>100,000</td>
<td>1,000,000</td>
</tr>
<tr>
<td><strong>ADMIN</strong></td>
<td>1,000</td>
<td>10,000</td>
<td>100,000</td>
</tr>
<tr>
<td><strong>SERVICE</strong></td>
<td>1,000</td>
<td>10,000</td>
<td>100,000</td>
</tr>
<tr>
<td><strong>USER</strong></td>
<td>60</td>
<td>1,000</td>
<td>10,000</td>
</tr>
<tr>
<td><strong>READONLY</strong></td>
<td>30</td>
<td>500</td>
<td>5,000</td>
</tr>
</tbody>
</table>
<h3 id="rate-limit-enforcement">Rate Limit Enforcement<a class="headerlink" href="#rate-limit-enforcement" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># Check rate limit before operation
allowed, error = security.check_rate_limit(user)

if not allowed:
    raise SecurityException(f&quot;Rate limit exceeded: {error}&quot;)

# Automatic enforcement in SecureDatabaseAPI
secure_api.create(user, data)  # Rate limit checked automatically
</code></pre>
<h3 id="rate-limit-response">Rate Limit Response<a class="headerlink" href="#rate-limit-response" title="Permanent link">&para;</a></h3>
<pre><code class="language-json">{
    &quot;error&quot;: &quot;Rate limit exceeded: 60 requests/minute&quot;,
    &quot;retry_after&quot;: 45,
    &quot;quota&quot;: {
        &quot;requests_per_minute&quot;: 60,
        &quot;requests_per_hour&quot;: 1000,
        &quot;requests_per_day&quot;: 10000
    }
}
</code></pre>
<hr />
<h2 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h2>
<h3 id="1-always-use-secure-api">1. Always Use Secure API<a class="headerlink" href="#1-always-use-secure-api" title="Permanent link">&para;</a></h3>
<p>âŒ <strong>Don't:</strong></p>
<pre><code class="language-python"># Direct database access bypasses security
result = database_api.read({&quot;title&quot;: &quot;Document&quot;})
</code></pre>
<p>âœ… <strong>Do:</strong></p>
<pre><code class="language-python"># Secure API enforces all security checks
result = secure_api.read(user, {&quot;title&quot;: &quot;Document&quot;})
</code></pre>
<h3 id="2-validate-user-context">2. Validate User Context<a class="headerlink" href="#2-validate-user-context" title="Permanent link">&para;</a></h3>
<p>âŒ <strong>Don't:</strong></p>
<pre><code class="language-python"># Anonymous access
data = secure_api.read(None, {})
</code></pre>
<p>âœ… <strong>Do:</strong></p>
<pre><code class="language-python"># Always provide authenticated user
user = authenticate_user(cert_or_token)
data = secure_api.read(user, {})
</code></pre>
<h3 id="3-use-least-privilege">3. Use Least Privilege<a class="headerlink" href="#3-use-least-privilege" title="Permanent link">&para;</a></h3>
<p>âŒ <strong>Don't:</strong></p>
<pre><code class="language-python"># Grant ADMIN role unnecessarily
user = User(&quot;alice&quot;, &quot;alice&quot;, &quot;alice@vcc.local&quot;, UserRole.ADMIN)
</code></pre>
<p>âœ… <strong>Do:</strong></p>
<pre><code class="language-python"># Grant minimum necessary role
user = User(&quot;alice&quot;, &quot;alice&quot;, &quot;alice@vcc.local&quot;, UserRole.USER)
</code></pre>
<h3 id="4-monitor-audit-logs">4. Monitor Audit Logs<a class="headerlink" href="#4-monitor-audit-logs" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># Regular audit log review
audit_log = secure_api.get_user_audit_log(admin)
failed_attempts = [e for e in audit_log if not e['success']]

if len(failed_attempts) &gt; threshold:
    alert_security_team(failed_attempts)
</code></pre>
<h3 id="5-handle-security-exceptions">5. Handle Security Exceptions<a class="headerlink" href="#5-handle-security-exceptions" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">try:
    result = secure_api.delete(user, record_id)
except SecurityException as e:
    logger.warning(f&quot;Security violation: {e}&quot;)
    return {&quot;error&quot;: &quot;Access denied&quot;, &quot;details&quot;: str(e)}
</code></pre>
<hr />
<h2 id="implementation-guide">Implementation Guide<a class="headerlink" href="#implementation-guide" title="Permanent link">&para;</a></h2>
<h3 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from security import User, UserRole, UDS3SecurityManager
from database.secure_api import SecureDatabaseAPI

# 1. Initialize security manager
security = UDS3SecurityManager(
    pki_ca_cert_path=&quot;/path/to/ca.pem&quot;,  # Optional: PKI auth
    enable_pki_auth=True,                 # Optional: Enable PKI
    enable_rate_limiting=True,
    enable_audit_logging=True
)

# 2. Wrap your database API
from database.database_api_postgresql import PostgreSQLDatabaseAPI

pg_api = PostgreSQLDatabaseAPI(config)
secure_pg = SecureDatabaseAPI(pg_api, security)

# 3. Create user (or authenticate via PKI)
user = User(
    user_id=&quot;user001&quot;,
    username=&quot;alice&quot;,
    email=&quot;alice@vcc.local&quot;,
    role=UserRole.USER
)

# 4. Use secure API for all operations
doc_id = secure_pg.create(user, {&quot;title&quot;: &quot;My Document&quot;})
docs = secure_pg.read(user, {&quot;title&quot;: &quot;My Document&quot;})
secure_pg.update(user, doc_id, {&quot;content&quot;: &quot;Updated&quot;})
secure_pg.delete(user, doc_id)
</code></pre>
<h3 id="integration-with-existing-code">Integration with Existing Code<a class="headerlink" href="#integration-with-existing-code" title="Permanent link">&para;</a></h3>
<pre><code class="language-python"># Before (insecure)
class MyService:
    def __init__(self, database_api):
        self.db = database_api

    def get_documents(self):
        return self.db.read({})  # âŒ No access control!

# After (secure)
class MyService:
    def __init__(self, secure_database_api):
        self.db = secure_database_api

    def get_documents(self, user):
        return self.db.read(user, {})  # âœ… Row-level security!
</code></pre>
<hr />
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<h3 id="security-test-suite">Security Test Suite<a class="headerlink" href="#security-test-suite" title="Permanent link">&para;</a></h3>
<p>The UDS3 Security Layer includes comprehensive tests:</p>
<pre><code class="language-bash"># Run all security tests
pytest tests/test_uds3_security.py -v

# Run specific test class
pytest tests/test_uds3_security.py::TestRowLevelSecurity -v
</code></pre>
<h3 id="test-coverage">Test Coverage<a class="headerlink" href="#test-coverage" title="Permanent link">&para;</a></h3>
<ul>
<li>âœ… <strong>Row-Level Security</strong> - Users can only access own data</li>
<li>âœ… <strong>Permission Checks</strong> - Roles have correct permissions</li>
<li>âœ… <strong>Audit Logging</strong> - All operations logged</li>
<li>âœ… <strong>Rate Limiting</strong> - Quotas enforced</li>
<li>âœ… <strong>Privilege Escalation Prevention</strong> - Cannot change ownership</li>
<li>âœ… <strong>Batch Operations</strong> - Security for bulk operations</li>
</ul>
<h3 id="example-security-test">Example Security Test<a class="headerlink" href="#example-security-test" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">def test_user_cannot_read_others_data(secure_api, alice, bob):
    &quot;&quot;&quot;User cannot read data owned by another user&quot;&quot;&quot;
    # Alice creates document
    doc_id = secure_api.create(alice, {&quot;title&quot;: &quot;Alice's Secret&quot;})

    # Bob tries to read Alice's document
    doc = secure_api.read_by_id(bob, doc_id)

    # Should be denied
    assert doc is None  # âœ… Access denied
</code></pre>
<hr />
<h2 id="security-checklist">Security Checklist<a class="headerlink" href="#security-checklist" title="Permanent link">&para;</a></h2>
<p>Use this checklist for secure UDS3 deployments:</p>
<ul>
<li>[ ] <strong>PKI Integration</strong></li>
<li>[ ] PKI CA certificate configured</li>
<li>[ ] CRL endpoint accessible</li>
<li>
<p>[ ] Certificate validation enabled</p>
</li>
<li>
<p>[ ] <strong>Access Control</strong></p>
</li>
<li>[ ] All database APIs wrapped with SecureDatabaseAPI</li>
<li>[ ] User context required for all operations</li>
<li>
<p>[ ] Least privilege roles assigned</p>
</li>
<li>
<p>[ ] <strong>Audit Logging</strong></p>
</li>
<li>[ ] Audit logging enabled</li>
<li>[ ] Logs regularly reviewed</li>
<li>
<p>[ ] Failed access attempts monitored</p>
</li>
<li>
<p>[ ] <strong>Rate Limiting</strong></p>
</li>
<li>[ ] Rate limits configured per role</li>
<li>[ ] DOS protection active</li>
<li>
<p>[ ] Quota violations logged</p>
</li>
<li>
<p>[ ] <strong>Testing</strong></p>
</li>
<li>[ ] Security tests passing</li>
<li>[ ] Penetration testing completed</li>
<li>
<p>[ ] Privilege escalation tests passed</p>
</li>
<li>
<p>[ ] <strong>Monitoring</strong></p>
</li>
<li>[ ] Security metrics tracked</li>
<li>[ ] Alerting configured</li>
<li>[ ] Incident response plan ready</li>
</ul>
<hr />
<h2 id="support-contact">Support &amp; Contact<a class="headerlink" href="#support-contact" title="Permanent link">&para;</a></h2>
<p>For security issues or questions:</p>
<ul>
<li><strong>Author</strong>: Martin KrÃ¼ger (ma.krueger@outlook.com)</li>
<li><strong>Documentation</strong>: <code>/docs/SECURITY.md</code></li>
<li><strong>Issue Tracker</strong>: https://github.com/makr-code/VCC-UDS3/issues</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: 24. Oktober 2025<br />
<strong>Version</strong>: 1.0.0<br />
<strong>Status</strong>: Production Ready âœ…</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  ZurÃ¼ck zum Seitenanfang
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "content.code.copy", "content.action.edit", "toc.follow"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>